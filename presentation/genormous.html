<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<title>Intro to GenORMous</title>
<!-- metadata -->
<meta name="generator" content="S5" />
<meta name="version" content="S5 1.1" />
<meta name="presdate" content="20050728" />
<meta name="author" content="Eric A. Meyer" />
<meta name="company" content="Complex Spiral Consulting" />
<!-- configuration parameters -->
<meta name="defaultView" content="slideshow" />
<meta name="controlVis" content="hidden" />
<!-- style sheet links -->
<link rel="stylesheet" href="ui/default/slides.css" type="text/css" media="projection" id="slideProj" />
<link rel="stylesheet" href="ui/default/outline.css" type="text/css" media="screen" id="outlineStyle" />
<link rel="stylesheet" href="ui/default/print.css" type="text/css" media="print" id="slidePrint" />
<link rel="stylesheet" href="ui/default/opera.css" type="text/css" media="projection" id="operaFix" />
<!-- S5 JS -->
<script src="ui/default/slides.js" type="text/javascript"></script>

<style type="text/css"><!--
.syntax0 {
color: #000000;
}
.syntax1 {
color: #cc0000;
}
.syntax2 {
color: #ff8400;
}
.syntax3 {
color: #6600cc;
}
.syntax4 {
color: #cc6600;
}
.syntax5 {
color: #ff0000;
}
.syntax6 {
color: #000099;
font-weight: bold;
}
.syntax7 {
background: #ffffcc;
color: #ff0066;
}
.syntax8 {
color: #006699;
font-weight: bold;
}
.syntax9 {
color: #009966;
font-weight: bold;
}
.syntax10 {
color: #0099ff;
font-weight: bold;
}
.syntax11 {
color: #66ccff;
font-weight: bold;
}
.syntax12 {
color: #02b902;
}
.syntax13 {
color: #ff00cc;
}
.syntax14 {
color: #cc00cc;
}
.syntax15 {
color: #9900cc;
}
.syntax16 {
color: #6600cc;
}
.syntax17 {
color: #0000ff;
}
.syntax18 {
color: #000000;
font-weight: bold;
}
.gutter {
background: #dbdbdb;
color: #000000;
}
.gutterH {
background: #dbdbdb;
color: #990066;
}
--></style>

</head>
<body>

<div class="layout">
<div id="controls"><!-- DO NOT EDIT --></div>
<div id="currentSlide"><!-- DO NOT EDIT --></div>
<div id="header"></div>
<div id="footer">
<h1>Utah Open Source Conference</h1>
<h2>Introduction to GenORMous</h2>
</div>

</div>


<div class="presentation">

<div class="slide">
<h1>Introduction to GenORMous</h1>
<h3>Brian Hawkins</h3>
<h4>Sr Software Engineer at Lingotek</h4>
</div>


<div class="slide">
<h1>Bad SQL</h1>
<pre><span class="syntax0">statement.<span class="syntax6">executeUpdate</span><span class="syntax18">(</span>
 <span class="syntax13">&quot;</span><span class="syntax13">update</span><span class="syntax13"> </span><span class="syntax13">coaches</span><span class="syntax13"> </span><span class="syntax13">set</span><span class="syntax13"> </span><span class="syntax13">first_name</span><span class="syntax13"> </span><span class="syntax13">=</span><span class="syntax13"> </span><span class="syntax13">'</span><span class="syntax13">&quot;</span><span class="syntax18">+</span>coach.m_firstName<span class="syntax18">+</span>
 <span class="syntax13">&quot;</span><span class="syntax13">',</span><span class="syntax13"> </span><span class="syntax13">last_name</span><span class="syntax13"> </span><span class="syntax13">=</span><span class="syntax13"> </span><span class="syntax13">'</span><span class="syntax13">&quot;</span><span class="syntax18">+</span>coach.m_lastName<span class="syntax18">+</span>
 <span class="syntax13">&quot;</span><span class="syntax13">',</span><span class="syntax13"> </span><span class="syntax13">phone</span><span class="syntax13"> </span><span class="syntax13">=</span><span class="syntax13"> </span><span class="syntax13">'</span><span class="syntax13">&quot;</span><span class="syntax18">+</span>coach.m_phone<span class="syntax18">+</span><span class="syntax13">&quot;</span><span class="syntax13">'</span><span class="syntax13"> </span><span class="syntax13">where</span><span class="syntax13"> </span><span class="syntax13">coach_id</span><span class="syntax13"> </span><span class="syntax13">=</span><span class="syntax13"> </span><span class="syntax13">'</span><span class="syntax13">&quot;</span><span class="syntax18">+</span>
 coach.m_coachId<span class="syntax18">+</span><span class="syntax13">&quot;</span><span class="syntax13">'</span><span class="syntax13">&quot;</span><span class="syntax18">)</span>;
</span></pre>

<ul class="incremental">
<li>Unsafe</li>
<li>Poor performance</li>
<li>Hard to unit test</li>
</ul>

</div>

<!-- ======================================================================= -->

<div class="slide">
<h1>Why Use SQL at All?</h1>

<ul class="incremental">
<li>Efficiency</li>
<li>DB specific operations</li>
</ul>

</div>

<!-- ======================================================================= -->


<div class="slide">
<h1>Goals of GenORMous</h1>
<ol class="incremental">
<li>User defined SQL</li>
<li>Framework for unit testing SQL</li>
<li>Object view of tables and queries</li>
<li>Simple to use</li>
<li>Confident schema changes</li>
<li>Minimize XML usage</li>
</ol>
</div>

<!-- ======================================================================= -->
<div class="slide">
<h1>Why Generated Source Code?</h1>
<ul class="incremental">

<li>You have a definition file</li>
<li>Performance</li>
<li>Easy to maintain</li>
<li>Custom code without the work</li>

</ul>
</div>

<!-- ======================================================================= -->
<div class="slide">
<h1>What Does GenORMous Generate?</h1>
<ul>
<li>Two objects for each table</li>
<li>An object for each custom query</li>
<li>Utility classes</li>
<li>create.sql</li>
<li>Graph of database</li>
</ul>
</div>


<!-- ======================================================================= -->
<div class="slide">
<h1>Graph of Database</h1>
<center>
<img src="tables.png" height="400"/>
</center>
</div>

<!-- ======================================================================= -->
<div class="slide">
<h1>Table Definition File</h1>

<pre><span class="syntax0"><span class="syntax9">&lt;!</span><span class="syntax9">DOCTYPE</span><span class="syntax9"> </span><span class="syntax9">tables</span><span class="syntax9"> </span><span class="syntax9">SYSTEM</span><span class="syntax9"> </span><span class="syntax13">&quot;</span><span class="syntax13">
  http://genormous.googlecode.com/svn/trunk/genormous/doc/tables_1.0.dtd</span><span class="syntax13">&quot;</span><span class="syntax9">&gt;</span>
<span class="syntax17">&lt;</span><span class="syntax17">tables</span><span class="syntax17">&gt;</span>
 <span class="syntax17">&lt;</span><span class="syntax17">table</span><span class="syntax17"> </span><span class="syntax17">name</span><span class="syntax17">=</span><span class="syntax13">&quot;</span><span class="syntax13">book</span><span class="syntax13">&quot;</span><span class="syntax17">&gt;</span>
  <span class="syntax17">&lt;</span><span class="syntax17">col</span><span class="syntax17"> </span><span class="syntax17">name</span><span class="syntax17">=</span><span class="syntax13">&quot;</span><span class="syntax13">title</span><span class="syntax13">&quot;</span><span class="syntax17"> </span><span class="syntax17">type</span><span class="syntax17">=</span><span class="syntax13">&quot;</span><span class="syntax13">string</span><span class="syntax13">&quot;</span><span class="syntax17">/</span><span class="syntax17">&gt;</span>
  <span class="syntax17">&lt;</span><span class="syntax17">col</span><span class="syntax17"> </span><span class="syntax17">name</span><span class="syntax17">=</span><span class="syntax13">&quot;</span><span class="syntax13">isbn</span><span class="syntax13">&quot;</span><span class="syntax17"> </span><span class="syntax17">type</span><span class="syntax17">=</span><span class="syntax13">&quot;</span><span class="syntax13">string</span><span class="syntax13">&quot;</span><span class="syntax17">/</span><span class="syntax17">&gt;</span>
  <span class="syntax17">&lt;</span><span class="syntax17">col</span><span class="syntax17"> </span><span class="syntax17">name</span><span class="syntax17">=</span><span class="syntax13">&quot;</span><span class="syntax13">call_number</span><span class="syntax13">&quot;</span><span class="syntax17"> </span><span class="syntax17">type</span><span class="syntax17">=</span><span class="syntax13">&quot;</span><span class="syntax13">string</span><span class="syntax13">&quot;</span><span class="syntax17"> </span><span class="syntax17">
   primary_key</span><span class="syntax17">=</span><span class="syntax13">&quot;</span><span class="syntax13">true</span><span class="syntax13">&quot;</span><span class="syntax17">/</span><span class="syntax17">&gt;</span>
  <span class="syntax17">&lt;</span><span class="syntax17">col</span><span class="syntax17"> </span><span class="syntax17">name</span><span class="syntax17">=</span><span class="syntax13">&quot;</span><span class="syntax13">checked_out</span><span class="syntax13">&quot;</span><span class="syntax17"> </span><span class="syntax17">type</span><span class="syntax17">=</span><span class="syntax13">&quot;</span><span class="syntax13">integer</span><span class="syntax13">&quot;</span><span class="syntax17"> </span><span class="syntax17">
   allow_null</span><span class="syntax17">=</span><span class="syntax13">&quot;</span><span class="syntax13">true</span><span class="syntax13">&quot;</span><span class="syntax17">&gt;</span>
   <span class="syntax17">&lt;</span><span class="syntax17">reference</span><span class="syntax17"> </span><span class="syntax17">column</span><span class="syntax17">=</span><span class="syntax13">&quot;</span><span class="syntax13">id</span><span class="syntax13">&quot;</span><span class="syntax17"> </span><span class="syntax17">table</span><span class="syntax17">=</span><span class="syntax13">&quot;</span><span class="syntax13">patron</span><span class="syntax13">&quot;</span><span class="syntax17">/</span><span class="syntax17">&gt;</span>
  <span class="syntax17">&lt;</span><span class="syntax17">/</span><span class="syntax17">col</span><span class="syntax17">&gt;</span>
 <span class="syntax17">&lt;</span><span class="syntax17">/</span><span class="syntax17">table</span><span class="syntax17">&gt;</span>
<span class="syntax17">&lt;</span><span class="syntax17">/</span><span class="syntax17">tables</span><span class="syntax17">&gt;</span>
</span></pre>

</div>

<!-- ======================================================================= -->
<div class="slide">
<h1>Generated Classes</h1>
<img src="genormous.png"/>
</div>

<!-- ======================================================================= -->
<div class="slide">
<h1>Connection Handling</h1>
<pre><span class="syntax0"><span class="syntax8">try</span>
  <span class="syntax18">{</span>
  GenOrmDataSource.<span class="syntax6">begin</span><span class="syntax18">(</span><span class="syntax18">)</span>;
  ...
  GenOrmDataSource.<span class="syntax6">commit</span><span class="syntax18">(</span><span class="syntax18">)</span>;
  <span class="syntax18">}</span>
<span class="syntax8">finally</span>
  <span class="syntax18">{</span>
  GenOrmDataSource.<span class="syntax6">close</span><span class="syntax18">(</span><span class="syntax18">)</span>;
  <span class="syntax18">}</span>
</span></pre>
</div>

<!-- ======================================================================= -->
<div class="slide">
<h1>Creating a Record</h1>
<pre><span class="syntax0">Book book <span class="syntax18">=</span> Book.factory.<span class="syntax6">create</span><span class="syntax18">(</span>m_callNumber<span class="syntax18">)</span>;
book.<span class="syntax6">setTitle</span><span class="syntax18">(</span>m_title<span class="syntax18">)</span>;
book.<span class="syntax6">setIsbn</span><span class="syntax18">(</span>m_isbn<span class="syntax18">)</span>;
</span></pre>
</div>


<!-- ======================================================================= -->

<div class="slide">
<h1>Finding a Record</h1>
<pre><span class="syntax0">Book book <span class="syntax18">=</span> Book.factory.<span class="syntax6">find</span><span class="syntax18">(</span>m_callNumber<span class="syntax18">)</span>;
<span class="syntax8">if</span> <span class="syntax18">(</span>book <span class="syntax18">!</span><span class="syntax18">=</span> <span class="syntax14">null</span><span class="syntax18">)</span>
  book.<span class="syntax6">setCheckedOutNull</span><span class="syntax18">(</span><span class="syntax18">)</span>;
</span></pre>
</div>

<!-- ======================================================================= -->
<div class="slide">
<h1>Table Walking</h1>

<pre><span class="syntax0">Patron pat <span class="syntax18">=</span> book.<span class="syntax6">getCheckedOutRef</span><span class="syntax18">()</span>;
</span></pre>

</div>
<!-- ======================================================================= -->

<div class="slide">
<h1>Custom Select</h1>
<pre><span class="syntax0"><span class="syntax17">&lt;</span><span class="syntax17">table</span><span class="syntax17"> </span><span class="syntax17">name</span><span class="syntax17">=</span><span class="syntax13">&quot;</span><span class="syntax13">book</span><span class="syntax13">&quot;</span><span class="syntax17">&gt;</span>
  ...
  <span class="syntax17">&lt;</span><span class="syntax17">query</span><span class="syntax17"> </span><span class="syntax17">name</span><span class="syntax17">=</span><span class="syntax13">&quot;</span><span class="syntax13">books_checked_out</span><span class="syntax13">&quot;</span><span class="syntax17"> </span><span class="syntax17">result_type</span><span class="syntax17">=</span><span class="syntax13">&quot;</span><span class="syntax13">multi</span><span class="syntax13">&quot;</span><span class="syntax17">&gt;</span>
    <span class="syntax17">&lt;</span><span class="syntax17">input</span><span class="syntax17">&gt;</span>
      <span class="syntax17">&lt;</span><span class="syntax17">param</span><span class="syntax17"> </span><span class="syntax17">name</span><span class="syntax17">=</span><span class="syntax13">&quot;</span><span class="syntax13">patron</span><span class="syntax13">&quot;</span><span class="syntax17"> </span><span class="syntax17">type</span><span class="syntax17">=</span><span class="syntax13">&quot;</span><span class="syntax13">integer</span><span class="syntax13">&quot;</span><span class="syntax17"> </span><span class="syntax17">test</span><span class="syntax17">=</span><span class="syntax13">&quot;</span><span class="syntax13">1</span><span class="syntax13">&quot;</span><span class="syntax17">/</span><span class="syntax17">&gt;</span>
    <span class="syntax17">&lt;</span><span class="syntax17">/</span><span class="syntax17">input</span><span class="syntax17">&gt;</span>
    <span class="syntax17">&lt;</span><span class="syntax17">sql</span><span class="syntax17">&gt;</span>
      from book this
      where this.checked_out = ?
      order by title
    <span class="syntax17">&lt;</span><span class="syntax17">/</span><span class="syntax17">sql</span><span class="syntax17">&gt;</span>
  <span class="syntax17">&lt;</span><span class="syntax17">/</span><span class="syntax17">query</span><span class="syntax17">&gt;</span>
<span class="syntax17">&lt;</span><span class="syntax17">/</span><span class="syntax17">table</span><span class="syntax17">&gt;</span>
</span></pre>
</div>

<!-- ======================================================================= -->
<div class="slide">
<h1>Custom Select Cont.</h1>
<pre><span class="syntax0">Book.ResultSet rs <span class="syntax18">=</span> Book.factory.<span class="syntax6">getBooksCheckedOut</span><span class="syntax18">(
    </span>m_patron.<span class="syntax6">getId</span><span class="syntax18">(</span><span class="syntax18">)</span><span class="syntax18">)</span>;
    
<span class="syntax8">while</span> <span class="syntax18">(</span>rs.<span class="syntax6">next</span><span class="syntax18">(</span><span class="syntax18">)</span><span class="syntax18">)</span>
  <span class="syntax18">{</span>
  Book book <span class="syntax18">=</span> rs.<span class="syntax6">getRecord</span><span class="syntax18">(</span><span class="syntax18">)</span>;
  ...
  <span class="syntax18">}</span>
rs.<span class="syntax6">close</span><span class="syntax18">(</span><span class="syntax18">)</span>;
</span></pre>
</div>

<!-- ======================================================================= -->

<div class="slide">
<h1>Custom Query</h1>

<pre><span class="syntax0"><span class="syntax17">&lt;</span><span class="syntax17">query</span><span class="syntax17"> </span><span class="syntax17">name</span><span class="syntax17">=</span><span class="syntax13">&quot;</span><span class="syntax13">books_with_category</span><span class="syntax13">&quot;</span><span class="syntax17">&gt;</span>
 <span class="syntax17">&lt;</span><span class="syntax17">input</span><span class="syntax17">&gt;</span>
  <span class="syntax17">&lt;</span><span class="syntax17">param</span><span class="syntax17"> </span><span class="syntax17">name</span><span class="syntax17">=</span><span class="syntax13">&quot;</span><span class="syntax13">category_name</span><span class="syntax13">&quot;</span><span class="syntax17"> </span><span class="syntax17">type</span><span class="syntax17">=</span><span class="syntax13">&quot;</span><span class="syntax13">String</span><span class="syntax13">&quot;</span><span class="syntax17">/</span><span class="syntax17">&gt;</span>
 <span class="syntax17">&lt;</span><span class="syntax17">/</span><span class="syntax17">input</span><span class="syntax17">&gt;</span>
 <span class="syntax17">&lt;</span><span class="syntax17">return</span><span class="syntax17">&gt;</span>
  <span class="syntax17">&lt;</span><span class="syntax17">param</span><span class="syntax17"> </span><span class="syntax17">name</span><span class="syntax17">=</span><span class="syntax13">&quot;</span><span class="syntax13">title</span><span class="syntax13">&quot;</span><span class="syntax17"> </span><span class="syntax17">type</span><span class="syntax17">=</span><span class="syntax13">&quot;</span><span class="syntax13">String</span><span class="syntax13">&quot;</span><span class="syntax17">/</span><span class="syntax17">&gt;</span>
  <span class="syntax17">&lt;</span><span class="syntax17">param</span><span class="syntax17"> </span><span class="syntax17">name</span><span class="syntax17">=</span><span class="syntax13">&quot;</span><span class="syntax13">call_number</span><span class="syntax13">&quot;</span><span class="syntax17"> </span><span class="syntax17">type</span><span class="syntax17">=</span><span class="syntax13">&quot;</span><span class="syntax13">String</span><span class="syntax13">&quot;</span><span class="syntax17">/</span><span class="syntax17">&gt;</span>
  <span class="syntax17">&lt;</span><span class="syntax17">param</span><span class="syntax17"> </span><span class="syntax17">name</span><span class="syntax17">=</span><span class="syntax13">&quot;</span><span class="syntax13">category_name</span><span class="syntax13">&quot;</span><span class="syntax17"> </span><span class="syntax17">type</span><span class="syntax17">=</span><span class="syntax13">&quot;</span><span class="syntax13">String</span><span class="syntax13">&quot;</span><span class="syntax17">/</span><span class="syntax17">&gt;</span>
 <span class="syntax17">&lt;</span><span class="syntax17">/</span><span class="syntax17">return</span><span class="syntax17">&gt;</span>
 <span class="syntax17">&lt;</span><span class="syntax17">sql</span><span class="syntax17">&gt;</span>
  select b.title, b.call_number, ca.category_name
  from 
  book b left join category_assignment ca on 
  b.call_number = ca.call_number
  where ca.category_name = ?
  order by b.call_number
 <span class="syntax17">&lt;</span><span class="syntax17">/</span><span class="syntax17">sql</span><span class="syntax17">&gt;</span>
<span class="syntax17">&lt;</span><span class="syntax17">/</span><span class="syntax17">query</span><span class="syntax17">&gt;</span>
</span></pre>

</div>

<!-- ======================================================================= -->
<div class="slide">
<h1>Custom Query Cont</h1>

<pre><span class="syntax0">BooksWithCategoryQuery q <span class="syntax18">=</span> <span class="syntax8">new</span> <span class="syntax6">BooksWithCategoryQuery</span><span class="syntax18">(</span><span class="syntax18">)</span>;
BooksWithCategoryQuery.ResultSet rs <span class="syntax18">=</span> q.<span class="syntax6">runQuery</span><span class="syntax18">(</span>catName<span class="syntax18">)</span>;

<span class="syntax8">while</span> <span class="syntax18">(</span>rs.<span class="syntax6">next</span><span class="syntax18">(</span><span class="syntax18">)</span><span class="syntax18">)</span>
  <span class="syntax18">{</span>
  BooksWithCategoryQuery.Record rec <span class="syntax18">=</span> rs.<span class="syntax6">getRecord</span><span class="syntax18">(</span><span class="syntax18">)</span>;
  ... rec.<span class="syntax6">getTitle</span><span class="syntax18">(</span><span class="syntax18">)</span>;
  ... rec.<span class="syntax6">getCallNumber</span><span class="syntax18">(</span><span class="syntax18">)</span>;
  <span class="syntax18">}</span>
rs.<span class="syntax6">close</span><span class="syntax18">(</span><span class="syntax18">)</span>;
</span></pre>

</div>

<!-- ======================================================================= -->
<div class="slide">
<h1>Unit Tests</h1>

<pre><span class="syntax0">GenOrmUnitTest.<span class="syntax6">performUnitTests</span><span class="syntax18">()</span>;
</span></pre>

</div>

<!-- ======================================================================= -->
<div class="slide">
<h1>Demo</h1>
</div>

</div>

</body>
</html>
